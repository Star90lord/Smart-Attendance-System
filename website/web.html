<!DOCTYPE Divorce:index.html
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharda University SAS Enrollment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb; /* Light, elegant background */
            overflow-x: hidden;
        }
        
        .header-gradient {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6); /* Deep blue to light blue */
        }

        .card-container {
            border-radius: 1.5rem; /* More rounded */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
        }

        .drag-over {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border-left-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Custom Button Style */
        .btn-primary {
            background-color: #3b82f6;
            transition: all 0.2s ease;
        }
        .btn-primary:hover:enabled {
            background-color: #2563eb;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .btn-disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="min-h-screen flex flex-col justify-start items-center">
        <!-- University Header - Classy Look -->
        <header class="w-full header-gradient shadow-lg py-5 mb-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <!-- Placeholder Logo (Simulating a distinct university crest/monogram) -->
                    <!-- UPDATED: Replaced SVG with a rectangular placeholder image -->
                    <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center p-1 shadow-md overflow-hidden">
                        <!-- Using a white-on-blue placeholder for "SU" (Sharda University) -->
                        <img src="\db\sh1.png" 
                            alt="Sharda University Logo Placeholder" 
                            class="w-full h-full object-cover">
                    </div>
                    <h1 class="text-3xl font-extrabold text-white tracking-tight">SHARDA UNIVERSITY</h1>
                </div>
                <h2 class="text-xl font-medium text-white opacity-90 hidden sm:block">Attendance System Enrollment (SAS)</h2>
            </div>
        </header>

        <!-- Main Content Container -->
        <div class="w-full max-w-6xl p-4 sm:p-6 lg:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                <!-- Left Column: Inputs and Upload -->
                <div class="lg:col-span-2 bg-white p-8 card-container h-fit">
                    <h3 class="text-2xl font-semibold text-gray-700 mb-6 border-b pb-3">Enrollment Form</h3>
                    <div class="space-y-5">
                        
                        <!-- Student ID -->
                        <div>
                            <label for="roll-number-input" class="block text-sm font-medium text-gray-700">Student ID (Unique Roll Number)</label>
                            <input type="text" id="roll-number-input" placeholder="e.g., 2023CS001" data-field="student_id" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                        
                        <!-- Student Name -->
                        <div>
                            <label for="student-name-input" class="block text-sm font-medium text-gray-700">Student Full Name</label>
                            <input type="text" id="student-name-input" placeholder="e.g., Alex Johnson" data-field="student_name" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>

                        <!-- Group/Section Dropdown -->
                        <div>
                            <label for="group-section-select" class="block text-sm font-medium text-gray-700">Group / Section</label>
                            <select id="group-section-select" data-field="group_section" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                                <option value="" disabled selected>Select Group/Section</option>
                                <option value="G1">Group G1</option>
                                <option value="G2">Group G2</option>
                                <option value="Section A">Section A</option>
                                <option value="Section B">Section B</option>
                            </select>
                        </div>

                        <!-- Course/Specialization Dropdown -->
                        <div>
                            <label for="course-select" class="block text-sm font-medium text-gray-700">Course / Specialization</label>
                            <select id="course-select" data-field="course_id" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                                <option value="" disabled selected>Select Course</option>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>
                        
                        <!-- Drag and Drop Area -->
                        <div id="drop-zone" class="w-full aspect-square bg-white rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-gray-300 text-center p-6 transition-colors mt-6">
                            <div id="drop-zone-placeholder">
                                <svg class="w-16 h-16 mx-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                                <p class="mt-3 text-sm font-medium text-gray-600">Drag & drop clear photo here (JPG/PNG)</p>
                                <p class="text-xs text-gray-500">or</p>
                                <label for="student-photo-upload" class="mt-2 text-sm font-bold text-blue-600 hover:text-blue-700 cursor-pointer">
                                    Click to browse
                                </label>
                                <input type="file" id="student-photo-upload" class="hidden" accept="image/*">
                            </div>
                            <img id="image-preview" src="" alt="Student Photo Preview" class="hidden w-full h-full object-contain rounded-xl">
                        </div>

                        <!-- Enrollment Button -->
                        <button id="upload-data-btn" class="btn-disabled w-full text-white font-bold py-3 px-4 rounded-xl shadow-md focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 transition-transform" disabled>Upload Data & Enroll</button>
                    </div>
                </div>

                <!-- Right Column: Status and Messages -->
                <div class="lg:col-span-3">
                     <div id="initial-state" class="bg-white p-10 card-container flex flex-col items-center justify-center text-center min-h-[500px]">
                        <svg class="w-20 h-20 text-blue-400 opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.208 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.792 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.792 5 16.5 5s3.332.477 4.5 1.253v13C19.832 18.477 18.208 18 16.5 18s-3.332.477-4.5 1.253"></path></svg>
                        <h3 class="mt-6 text-xl font-bold text-gray-700">Digital Enrollment Gateway</h3>
                        <p class="text-gray-500 mt-2 max-w-md">This portal facilitates secure, professional enrollment and face encoding for the university's attendance system. Please fill all mandatory fields.</p>
                    </div>

                    <div id="processing-state" class="hidden bg-white p-10 card-container flex flex-col items-center justify-center min-h-[500px]">
                        <div class="spinner"></div>
                        <p class="mt-6 text-xl font-bold text-blue-700">Processing Enrollment and Encoding...</p>
                        <p class="text-gray-500 mt-2 text-sm">Validating credentials, detecting face geometry, and generating the 128D biometric vector on the backend server.</p>
                    </div>

                    <div id="data-display" class="hidden space-y-6 bg-white p-10 card-container fade-in min-h-[500px]">
                        <h2 class="text-3xl font-extrabold text-green-600 flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Enrollment Complete
                        </h2>
                        <p class="text-gray-600 border-b pb-4">The student's data and biometric encoding have been successfully secured and stored in the database. Ready for live attendance tracking.</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 text-left">
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-sm font-medium text-gray-500">Student ID</p>
                                <p id="roll-number-display" class="text-xl font-bold text-gray-900">-</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-sm font-medium text-gray-500">Full Name</p>
                                <p id="student-name-display" class="text-xl font-bold text-gray-900">-</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-sm font-medium text-gray-500">Course / Program</p>
                                <p id="course-display" class="text-xl font-bold text-gray-900">-</p>
                            </div>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p class="text-sm font-medium text-gray-500">Group/Section</p>
                                <p id="group-section-display" class="text-xl font-bold text-gray-900">-</p>
                            </div>
                        </div>
                        <button onclick="resetUI()" class="mt-6 w-full bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-xl hover:bg-gray-300 transition shadow-md">Enroll Next Student</button>
                    </div>
                    
                    <!-- Error State -->
                    <div id="error-state" class="hidden bg-red-50 border border-red-300 p-10 card-container flex flex-col items-center justify-center min-h-[500px]">
                        <svg class="w-16 h-16 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                        <h3 id="error-title" class="mt-4 text-2xl font-bold text-red-700">Upload Failed</h3>
                        <p id="error-message" class="text-red-500 mt-2">An unexpected error occurred or required data was missing.</p>
                        <p id="server-response" class="text-sm mt-4 text-red-400 font-mono bg-red-100 p-2 rounded-lg max-w-full overflow-x-auto"></p>
                        <button onclick="resetUI()" class="mt-6 bg-red-600 text-white font-bold py-3 px-4 rounded-xl hover:bg-red-700 transition shadow-md">Retry Enrollment</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Wrap all logic in an IIFE to prevent variable re-declaration errors
        (function() {
            // --- Configuration Data ---
            const API_ENDPOINT = 'http://127.0.0.1:5000/api/enroll_student'; // Flask default host/port
            const COURSES = [
                { id: 'CS101', name: 'Computer Science Fundamentals', specialization: false },
                { id: 'AI350', name: 'Artificial Intelligence & ML (Spec.)', specialization: true },
                { id: 'CY405', name: 'Cybersecurity & Forensics (Spec.)', specialization: true },
                { id: 'SE301', name: 'Software Engineering Practices (Spec.)', specialization: true },
            ];

            // --- DOM Elements Dictionary ---
            const D = {
                dropZone: document.getElementById('drop-zone'),
                fileUpload: document.getElementById('student-photo-upload'),
                imagePreview: document.getElementById('image-preview'),
                dropZonePlaceholder: document.getElementById('drop-zone-placeholder'),
                uploadDataBtn: document.getElementById('upload-data-btn'),
                rollInput: document.getElementById('roll-number-input'),
                nameInput: document.getElementById('student-name-input'),
                courseSelect: document.getElementById('course-select'),
                groupSelect: document.getElementById('group-section-select'),
                initialState: document.getElementById('initial-state'),
                processingState: document.getElementById('processing-state'),
                dataDisplay: document.getElementById('data-display'),
                errorState: document.getElementById('error-state'),
                errorTitle: document.getElementById('error-title'),
                errorMessage: document.getElementById('error-message'),
                serverResponse: document.getElementById('server-response')
            };

            let uploadedFile = null;
            
            // --- Core Functions ---

            /** Populates the course select dropdown. */
            function populateCourses() {
                const specializationGroup = document.createElement('optgroup');
                specializationGroup.label = 'Specializations';
                const coreGroup = document.createElement('optgroup');
                coreGroup.label = 'Core Courses';

                COURSES.forEach(course => {
                    const option = document.createElement('option');
                    option.value = course.id;
                    option.textContent = `${course.name}`;
                    if (course.specialization) {
                        specializationGroup.appendChild(option);
                    } else {
                        coreGroup.appendChild(option);
                    }
                });
                
                D.courseSelect.innerHTML = '<option value="" disabled selected>Select Course</option>';
                D.courseSelect.appendChild(specializationGroup);
                D.courseSelect.appendChild(coreGroup);
            }

            /** Handles file selection and updates the preview. */
            function handleFile(file) {
                if (file && file.type.startsWith('image/')) {
                    uploadedFile = file;
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        D.imagePreview.src = e.target.result;
                        D.imagePreview.classList.remove('hidden');
                        D.dropZonePlaceholder.classList.add('hidden');
                        checkFormValidity();
                    };
                    reader.readAsDataURL(file);
                } else if (file) {
                    showError("Invalid File Type", "Please upload a photo file (e.g., JPG, PNG).");
                    uploadedFile = null;
                }
            }
            
            /** Shows a specific UI state and hides all others. */
            function setUIState(state) {
                D.initialState.classList.add('hidden');
                D.processingState.classList.add('hidden');
                D.dataDisplay.classList.add('hidden');
                D.errorState.classList.add('hidden');

                if (state === 'initial') {
                    D.initialState.classList.remove('hidden');
                } else if (state === 'processing') {
                    D.processingState.classList.remove('hidden');
                } else if (state === 'success') {
                    D.dataDisplay.classList.remove('hidden');
                } else if (state === 'error') {
                    D.errorState.classList.remove('hidden');
                }
            }
            
            /** Displays an error message and switches to the error state. */
            function showError(title, message, details = "") {
                D.errorTitle.textContent = "Error: " + title;
                D.errorMessage.textContent = message;
                D.serverResponse.textContent = details ? `Server reported: ${details}` : "";
                setUIState('error');
            }

            /** Checks if all required fields are filled to enable the button. */
            function checkFormValidity() {
                const rollValid = D.rollInput.value.trim().length > 0;
                const courseSelected = D.courseSelect.value !== "";
                const groupSelected = D.groupSelect.value !== "";
                const fileUploaded = uploadedFile !== null;

                if (rollValid && courseSelected && groupSelected && fileUploaded) {
                    D.uploadDataBtn.disabled = false;
                    D.uploadDataBtn.classList.remove('btn-disabled');
                    D.uploadDataBtn.classList.add('btn-primary');
                } else {
                    D.uploadDataBtn.disabled = true;
                    D.uploadDataBtn.classList.add('btn-disabled');
                    D.uploadDataBtn.classList.remove('btn-primary');
                }
            }

            /** Sends data to the Flask backend using fetch. */
            async function uploadStudentData() {
                const rollNumber = D.rollInput.value.trim();
                const studentName = D.nameInput.value.trim() || 'N/A';
                const courseID = D.courseSelect.value;
                const groupSection = D.groupSelect.value;
                
                if (!rollNumber || !courseID || !groupSection || !uploadedFile) {
                    showError("Missing Required Fields", "Student ID, Group/Section, Course, and a Photo are required.");
                    return;
                }
                
                setUIState('processing');

                // 1. Create FormData object
                const formData = new FormData();
                formData.append('student_photo', uploadedFile); // The file itself
                formData.append('student_id', rollNumber);
                formData.append('student_name', studentName);
                formData.append('course_id', courseID);
                formData.append('group_section', groupSection);

                // 2. Perform the fetch request
                try {
                    const response = await fetch(API_ENDPOINT, {
                        method: 'POST',
                        body: formData // FormData automatically sets the correct headers
                    });

                    const result = await response.json();
                    
                    if (response.ok) {
                        // Successful response from the server (Status 200-299)
                        
                        // 3. Update success display
                        document.getElementById('roll-number-display').textContent = result.student_id;
                        document.getElementById('student-name-display').textContent = result.student_name;
                        document.getElementById('course-display').textContent = result.course_name;
                        document.getElementById('group-section-display').textContent = result.group_section;

                        setUIState('success');
                    } else {
                        // Server responded with an error status (e.g., 400, 500)
                        showError(
                            "Server Error (Status " + response.status + ")", 
                            result.message || "The server rejected the data.", 
                            result.error_details || "No further details available."
                        );
                    }

                } catch (error) {
                    // Network or CORS error
                    showError("Network Connection Error", "Could not connect to the Flask backend server. Ensure the server is running at " + API_ENDPOINT, error.message);
                }
            }
            
            /** Resets the form and UI state. */
            // Expose to window so it can be called from the HTML `onclick` attribute
            window.resetUI = function() {
                setUIState('initial');
                D.rollInput.value = '';
                D.nameInput.value = '';
                D.groupSelect.value = '';
                D.courseSelect.value = '';
                D.fileUpload.value = '';
                uploadedFile = null;
                D.imagePreview.classList.add('hidden');
                D.dropZonePlaceholder.classList.remove('hidden');
                D.serverResponse.textContent = "";
                checkFormValidity();
            }

            // --- Event Listeners and Initialization ---

            document.addEventListener('DOMContentLoaded', () => {
                populateCourses();
                checkFormValidity();
                
                // File input change
                D.fileUpload.addEventListener('change', (e) => {
                    handleFile(e.target.files[0]);
                });

                // Drag and Drop Events
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    D.dropZone.addEventListener(eventName, (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    }, false);
                });
                
                D.dropZone.addEventListener('dragenter', () => D.dropZone.classList.add('drag-over'), false);
                D.dropZone.addEventListener('dragover', () => D.dropZone.classList.add('drag-over'), false);
                D.dropZone.addEventListener('dragleave', () => D.dropZone.classList.remove('drag-over'), false);
                D.dropZone.addEventListener('drop', (e) => {
                    D.dropZone.classList.remove('drag-over');
                    const dt = e.dataTransfer;
                    handleFile(dt.files[0]);
                }, false);

                // Enrollment Button Click
                D.uploadDataBtn.addEventListener('click', uploadStudentData);

                // Input/Select Change for validation
                [D.rollInput, D.nameInput, D.courseSelect, D.groupSelect].forEach(element => {
                    element.addEventListener('input', checkFormValidity);
                    element.addEventListener('change', checkFormValidity);
                });
            });
        })(); // End of IIFE

    </script>
</body>
</html>
